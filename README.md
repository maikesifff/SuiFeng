# 随风仓储管理系统

一个基于Vue.js + Express.js + MySQL的现代化仓储管理系统，提供完整的仓库管理、产品管理、订单管理和路径规划功能。

## 🚀 功能特性

### 🔐 用户认证系统
- 多角色登录支持（系统管理员、仓库管理员、运输调度员、采购员、销售员、财务员等）
- JWT token认证
- 基于角色的权限控制系统
- 页面级和功能级权限控制
- 权限不足友好提示（不强制跳转登录页）

### 📦 产品管理
- 产品信息的增删改查
- 实时搜索和筛选功能（支持仓库、供应商筛选）
- 产品详情查看和编辑
- 供应商关联管理
- 仓库位置管理
- 价格和库存数量范围验证
- 基于权限的功能控制（编辑/删除按钮）

### 🏪 仓库管理  
- 仓库信息的完整CRUD操作
- 仓库编码自动生成
- 管理员分配和管理
- 仓库状态管理
- 地址和联系信息维护

### 📋 订单管理
- **简化的订单流程**：专注于订单状态流转
- **完整的状态管理**：已创建 → 处理中 → 已发货 → 已完成
- **批量操作功能**：多选订单批量处理/发货/取消
- **高级筛选**：状态筛选、实时搜索
- **数据导出**：CSV格式订单数据导出
- **权限控制**：基于角色的操作权限
- **订单取消和删除**：支持取消订单和删除已完成订单

### 🗺️ 路径规划
- **智能商品搜索**：支持商品名称模糊搜索
- **用户主动选择**：搜索结果列表供用户选择
- **可视化仓库布局**：5个货架区域(A-E区)，每区4个货架位
- **智能路径高亮**：目标货架红色脉冲，路径区域蓝色高亮
- **步骤指示器**：数字标记显示导航步骤
- **响应式设计**：适配不同屏幕尺寸

## 🛠️ 技术栈

### 前端
- **Vue.js 3** - 渐进式JavaScript框架
- **Element Plus** - Vue 3 UI组件库
- **Vue Router** - 单页面应用路由
- **Axios** - HTTP客户端
- **Vite** - 快速构建工具

### 后端
- **Node.js** - JavaScript运行环境
- **Express.js** - Web应用框架
- **Sequelize** - ORM数据库操作
- **MySQL** - 关系型数据库
- **JWT** - 身份认证

## 📁 项目结构

```
SuiFeng/
├── backend/                 # 后端服务
│   ├── app.js              # 应用入口
│   ├── config/             # 配置文件
│   │   ├── config.json     # 数据库配置
│   │   └── database.js     # 数据库连接
│   ├── models/             # 数据模型
│   ├── routes/             # API路由
│   ├── middleware/         # 中间件
│   │   ├── auth.js         # 认证中间件
│   │   ├── error.js        # 错误处理
│   │   └── validator.js    # 数据验证
│   ├── migrations/         # 数据库迁移
│   ├── seeders/           # 测试数据
│   └── utils/             # 工具函数
├── frontend/               # 前端应用
│   ├── src/
│   │   ├── components/    # 组件
│   │   │   ├── Header.vue  # 头部组件
│   │   │   └── Footer.vue  # 底部组件
│   │   ├── views/         # 页面
│   │   │   ├── login.vue          # 登录页面
│   │   │   ├── product.vue        # 产品管理
│   │   │   ├── product-detail.vue # 产品详情
│   │   │   ├── product-edit.vue   # 产品编辑
│   │   │   ├── warehouse.vue      # 仓库管理
│   │   │   ├── order-admin.vue    # 订单管理
│   │   │   └── path-planning.vue  # 路径规划
│   │   ├── router/        # 路由配置
│   │   ├── api/           # API接口
│   │   └── utils/         # 工具函数
│   │       ├── permission.js  # 权限控制
│   │       ├── request.js     # 请求拦截
│   │       └── validate.js    # 表单验证
│   └── public/            # 静态资源
└── README.md              # 项目说明
```

## 🚀 快速开始

### 环境要求
- Node.js >= 14.0.0
- MySQL >= 5.7
- npm 或 yarn

### 1. 克隆项目
```bash
git clone <repository-url>
cd SuiFeng
```

### 2. 后端设置
```bash
cd backend
npm install

# 配置数据库连接
# 编辑 config/config.json 文件，设置数据库连接信息
# 默认配置：
# - 用户名: root
# - 密码: root  
# - 数据库: logisticswarehousedb
# - 主机: 127.0.0.1

# 创建数据库
mysql -u root -p
CREATE DATABASE logisticswarehousedb;

# 运行数据库迁移
npx sequelize-cli db:migrate

# 导入测试数据
npx sequelize-cli db:seed:all

# 启动后端服务
npm start
```

### 3. 前端设置
```bash
cd frontend
npm install

# 启动前端开发服务器
npm run dev
```

### 4. 访问应用
- 前端地址：http://localhost:5173
- 后端API：http://localhost:3000

## 👥 测试账号

系统提供了以下测试账号：

| 用户名 | 密码 | 角色 | 主要权限 |
|--------|------|------|----------|
| admin | admin123 | 系统管理员 | 全部权限，包括删除订单 |
| manager | manager123 | 仓库管理员 | 仓库管理、产品管理 |
| warehouse | warehouse123 | 仓库管理员 | 库存管理、订单处理 |
| transport | transport123 | 运输调度员 | 运输管理、订单发货 |
| purchase | purchase123 | 采购员 | 采购管理、供应商管理 |
| sales | sales123 | 销售员 | 销售管理、客户订单 |
| finance | finance123 | 财务员 | 财务管理、订单统计 |

## 📊 数据库设计

系统包含以下主要数据表：

- **用户表** (`user`) - 用户账号信息
- **员工表** (`employee`) - 员工基本信息  
- **部门表** (`department`) - 组织架构
- **仓库表** (`warehouse`) - 仓库信息
- **供应商表** (`supplier`) - 供应商管理
- **产品表** (`product`) - 产品信息
- **库存表** (`inventory`) - 库存记录
- **订单表** (`order`) - 订单信息
- **配送表** (`delivery`) - 配送记录
- **货主表** (`shipper`) - 货主信息
- **车辆表** (`vehicle`) - 车辆管理
- **权限表** (`permission`) - 权限定义
- **角色表** (`role`) - 角色管理
- **员工角色表** (`employee_role`) - 员工角色关联
- **角色权限表** (`role_permission`) - 角色权限关联

## 🔧 API接口

### 认证接口
- `POST /auth/login` - 用户登录
- `GET /auth/profile` - 获取用户信息
- `PUT /auth/password` - 修改密码

### 产品管理
- `GET /product` - 获取产品列表（支持仓库、供应商筛选）
- `GET /product/:id` - 获取产品详情
- `POST /product` - 创建产品
- `PUT /product/:id` - 更新产品
- `DELETE /product/:id` - 删除产品

### 仓库管理
- `GET /warehouse` - 获取仓库列表
- `GET /warehouse/:id` - 获取仓库详情
- `POST /warehouse` - 创建仓库
- `PUT /warehouse/:id` - 更新仓库
- `DELETE /warehouse/:id` - 删除仓库
- `GET /warehouse/managers` - 获取管理员列表

### 订单管理
- `GET /order` - 获取订单列表（支持状态筛选）
- `GET /order/:id` - 获取订单详情
- `PUT /order/:id/process` - 订单处理
- `PUT /order/:id/ship` - 订单发货
- `PUT /order/:id/complete` - 订单完成
- `PUT /order/:id/cancel` - 取消订单
- `DELETE /order/:id` - 删除订单（仅系统管理员）
- `POST /order/batch/process` - 批量处理订单
- `POST /order/batch/ship` - 批量发货
- `POST /order/batch/cancel` - 批量取消
- `GET /order/export` - 导出订单数据

### 供应商管理
- `GET /supplier` - 获取供应商列表
- `GET /supplier/:id` - 获取供应商详情

### 库存管理
- `GET /inventory` - 获取库存列表
- `GET /inventory/:id` - 获取库存详情
- `PUT /inventory/:id` - 更新库存

## 🎯 主要功能演示

### 1. 登录系统
- 使用测试账号登录，系统会根据用户角色自动分配相应权限
- 权限不足时显示友好提示，不会强制跳转登录页
- 支持页面级和功能级权限控制

### 2. 产品管理
- 查看产品列表，支持实时搜索和筛选（仓库、供应商）
- 添加新产品，关联供应商和仓库，支持价格和库存范围验证
- 编辑产品信息，智能导航回到详情页
- 查看产品详情，完整的供应商和仓库信息展示
- 基于权限显示编辑/删除按钮

### 3. 仓库管理
- 查看所有仓库信息，支持状态管理
- 创建仓库时自动选择管理员，支持仓库编码输入
- 管理仓库基本信息和联系方式
- 支持仓库状态切换（启用/禁用）

### 4. 订单处理
- **简化的界面设计**：专注于订单状态流转，移除了新增和编辑功能
- **状态流转按钮**：已创建→处理中→已发货→已完成
- **批量操作**：支持多选订单进行批量处理、发货、取消
- **高级筛选**：按状态筛选，实时搜索功能
- **数据导出**：一键导出CSV格式订单数据
- **权限控制**：不同角色看到不同操作按钮
- **订单管理**：支持取消订单和删除已完成订单（仅管理员）

### 5. 路径规划
- **智能搜索**：输入商品名称，显示匹配结果列表
- **用户选择**：从搜索结果中选择目标商品
- **可视化布局**：清晰的5×4货架区域布局(A-E区)
- **路径高亮**：目标货架红色脉冲动画，路径蓝色高亮
- **导航指引**：数字步骤指示器，清晰的导航路径
- **响应式设计**：适配手机和平板设备

## 🔧 已修复的问题

### 仓库管理修复
- ✅ 修复仓库创建时缺少必填字段问题
- ✅ 添加仓库编码和管理员选择功能
- ✅ 修复管理员API的模型关联问题

### 产品管理优化
- ✅ 修复筛选功能无效问题
- ✅ 优化产品详情页面字段显示
- ✅ 修复编辑页面导航逻辑
- ✅ 完善产品创建和更新验证

### 订单管理升级
- ✅ 重新设计订单管理界面
- ✅ 实现完整的状态流转功能
- ✅ 添加批量操作和数据导出
- ✅ 修复状态匹配问题
- ✅ 实现权限控制系统

### 路径规划重构
- ✅ 修复搜索自动匹配问题
- ✅ 重新设计仓库布局和路径算法
- ✅ 优化动画效果和用户交互
- ✅ 修复界面覆盖和响应式问题

### 权限系统完善
- ✅ 实现基于角色的权限控制
- ✅ 优化权限错误处理
- ✅ 添加Vue指令权限控制
- ✅ 完善页面级权限检查

## 📝 更新日志

### v1.0.0 (2025-06-19)
- ✅ 完成用户认证系统和权限控制
- ✅ 实现产品管理功能（包括搜索、筛选、CRUD操作）
- ✅ 实现仓库管理功能（包括管理员分配、状态管理）
- ✅ 实现企业级订单管理功能（状态流转、批量操作、数据导出）
- ✅ 实现智能路径规划功能（可视化布局、路径高亮、导航指引）
- ✅ 完成数据库设计和测试数据导入
- ✅ 实现前后端API完整对接
- ✅ 修复所有主要功能模块的已知问题
- ✅ 完善权限控制和用户体验优化

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

---

**随风仓储管理系统** - 让仓库管理更智能、更高效！ 🚀 